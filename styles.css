/* 
   Zhihu Pure Reader - Pro Customizable Version
*/

/* 1. CSS Variables (Default Values) */
:root {
    --bg-color: #fdf6e3;
    --text-color: #2c3e50;
    --heading-color: #111;
    --font-stack: "Georgia", "Source Han Serif SC", serif;
    --font-size: 20px;     /* Default, controlled by JS */
    --content-width: 900px; /* Default, controlled by JS */
    --line-height: 1.8;
}

/* Theme Definitions */
body[data-theme="warm"] { --bg-color: #fdf6e3; --text-color: #2c3e50; --heading-color: #111; }
body[data-theme="dark"] { --bg-color: #1a1a1a; --text-color: #b0b0b0; --heading-color: #ddd; }
body[data-theme="white"] { --bg-color: #ffffff; --text-color: #222; --heading-color: #000; }
body[data-theme="sepia"] { --bg-color: #f4ecd8; --text-color: #5b4636; --heading-color: #433422; }

/* Font Definitions */
body[data-font="serif"] { --font-stack: "Georgia", "Source Han Serif SC", "Noto Serif CJK SC", serif; }
body[data-font="sans"] { --font-stack: "Helvetica Neue", "PingFang SC", "Microsoft YaHei", sans-serif; }


/* === ROOT LEVEL BACKGROUND FIX === */
/* Force background color on the very root elements to prevent white strips */
html, 
.pure-reader-mode,
.pure-reader-mode body,
.pure-reader-mode .Post-Page, /* Critical for Column pages */
.pure-reader-mode .Post-NormalMain,
.pure-reader-mode .Post-Main {
    background-color: var(--bg-color) !important;
    min-height: 100vh !important;
}

/* Only apply in Reader Mode */
.pure-reader-mode {
    color: var(--text-color) !important;
    transition: background-color 0.3s, color 0.3s;
}

/* Hide Distractions */
.pure-reader-mode .AppHeader, 
.pure-reader-mode .ColumnPageHeader, /* Column Header */
.pure-reader-mode .CornerButtons,
.pure-reader-mode .GlobalSideBar,
.pure-reader-mode .Question-sideColumn,
.pure-reader-mode .TopstorySideBar,
.pure-reader-mode .ContentItem-actions,
.pure-reader-mode .ZVideo-mobileLink,
.pure-reader-mode .Ad,
.pure-reader-mode .Pc-card,
.pure-reader-mode .MoreAnswers,
.pure-reader-mode .Reward,
.pure-reader-mode .FollowButton,
.pure-reader-mode .Post-SideActions, 
.pure-reader-mode .Post-Sub, 
.pure-reader-mode .Post-NormalSub,
.pure-reader-mode .Sticky,
.pure-reader-mode .Catalog, 
.pure-reader-mode .Post-Writer, 
.pure-reader-mode .AuthorInfo,
.pure-reader-mode .UserCard,
.pure-reader-mode .Post-Side, /* The entire sidebar container */
.pure-reader-mode .Post-SideColumn,
.pure-reader-mode div[role="complementary"] /* Accessibility role often used for sidebars */
{
    display: none !important;
}


/* Layout: Dynamic Width */
.pure-reader-mode .Question-main, 
.pure-reader-mode .Topstory-main,
.pure-reader-mode .Post-Main {
    width: var(--content-width) !important; /* Controlled by Slider */
    max-width: 95vw !important;
    margin: 0 auto !important;
    padding: 0 !important;
    float: none !important;
    display: block !important;
}

.pure-reader-mode .Question-mainColumn, 
.pure-reader-mode .Topstory-mainColumn {
    width: 100% !important;
    margin: 0 !important;
}

/* Container Backgrounds */
.pure-reader-mode .Card,
.pure-reader-mode .ContentItem,
.pure-reader-mode .AnswerItem,
.pure-reader-mode .Post-Main, /* Ensure Column Main bg is correct */
.pure-reader-mode .Post-Content {
    box-shadow: none !important;
    border: none !important;
    background: var(--bg-color) !important;
}

/* Typography - Apply variables */
.pure-reader-mode .RichContent-inner, 
.pure-reader-mode .RichContent,
.pure-reader-mode .Post-RichText,
.pure-reader-mode p {
    font-family: var(--font-stack) !important;
    font-size: var(--font-size) !important;
    line-height: var(--line-height) !important;
    color: var(--text-color) !important;
    text-align: justify !important;
}

/* === Code Blocks Optimization === */
.pure-reader-mode pre,
.pure-reader-mode code,
.pure-reader-mode .highlight,
.pure-reader-mode .ztext-code {
    font-family: "Fira Code", "Consolas", "Monaco", "Andale Mono", monospace !important;
    font-size: 0.9em !important;
    line-height: 1.6 !important;
    background-color: rgba(0, 0, 0, 0.05) !important; /* Adaptive semi-transparent bg */
    border-radius: 6px !important;
    border: 1px solid rgba(0,0,0,0.1) !important;
    overflow-x: auto !important; /* Allow horizontal scroll */
    /* color: inherit !important;  <-- Removed to allow syntax highlighting */
    white-space: pre !important;
}

.pure-reader-mode pre {
    padding: 15px !important;
    margin: 25px 0 !important;
}

/* Dark mode specifics for code */
body[data-theme="dark"] .pure-reader-mode pre,
body[data-theme="dark"] .pure-reader-mode code,
body[data-theme="dark"] .pure-reader-mode .highlight {
    background-color: rgba(255, 255, 255, 0.1) !important; 
    border-color: rgba(255,255,255,0.1) !important;
    /* Allow text color to be determined by syntax highlighter or fallback */
}

/* === Fix Residual White Backgrounds === */
/* Force these containers to be transparent so the body theme color shows through */
.pure-reader-mode .Post-RichTextContainer,
.pure-reader-mode .RichContent-inner > div,
.pure-reader-mode .ztext,
.pure-reader-mode blockquote {
    background-color: transparent !important;
    background: transparent !important;
}

/* Blockquote Styling */
.pure-reader-mode blockquote {
    border-left: 4px solid var(--link-color) !important;
    padding-left: 16px !important;
    margin-left: 0 !important;
    color: var(--text-color) !important;
    opacity: 0.8;
}

/* Headings */
.pure-reader-mode h1, 
.pure-reader-mode h2, 
.pure-reader-mode h3,
.pure-reader-mode .QuestionHeader-title,
.pure-reader-mode .Post-Title {
    font-family: "Helvetica Neue", Arial, sans-serif !important;
    margin-top: 1.5em !important;
    color: var(--heading-color) !important;
}

/* Images */
.pure-reader-mode img {
    max-width: 100% !important;
    height: auto !important;
    margin: 20px auto !important;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

/* Header Area */
.pure-reader-mode .QuestionHeader-title {
    font-size: 32px !important;
    text-align: center !important;
    margin-bottom: 30px !important;
}

.pure-reader-mode .QuestionHeader {
    background: transparent !important;
    box-shadow: none !important;
    padding-top: 40px !important;
}

.pure-reader-mode .QuestionHeader-content {
    width: 100% !important;
    padding: 0 !important;
}